<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OnePay Statement Processor</title>
    <link rel="stylesheet" href="style.css">
    <!-- PDF.js from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Secure OnePay Statement Processor</h1>
            <p>Process your statements locally. No data leaves your browser.</p>
        </header>

        <main>
            <section class="guide-section">
                <details>
                    <summary>How to use & Download Statements</summary>
                    <div class="guide-content">
                        <ol class="steps-list">
                            <li>Go to your <strong>OnePay account</strong> (<a href="https://web.onepay.com/" target="_blank">https://web.onepay.com</a>) in the browser.</li>
                            <li>Click on your <strong>Initials</strong> in the top right corner.</li>
                            <li>Click on <strong>Documents</strong>, then select <strong>Statements</strong>.</li>
                            <li>Download the statement(s) you want to process.</li>
                            <li>Click <strong>Select PDF File(s)</strong> below (or drag & drop) and select the statement(s) you want to process.</li>
                            <li>Use the <strong>Export CSV</strong> button to save the extracted data as a spreadsheet file.</li>
                        </ol>
                        <div class="tip-box">
                            <span class="tip-icon">ðŸ’¡</span>
                            <p><strong>Pro Tip:</strong> You can process multiple statements at once! <br>
                            Hold <code>Ctrl</code> (Windows) or <code>Cmd</code> (Mac) to select multiple files in the dialog.</p>
                        </div>
                    </div>
                </details>
            </section>

            <section class="upload-section">
                <div id="drop-zone" class="drop-zone">
                    <p>Drag & Drop your PDF statement(s) here</p>
                    <p>or</p>
                    <input type="file" id="file-input" accept=".pdf" multiple hidden>
                    <button id="select-btn" class="btn primary">Select PDF File(s)</button>
                </div>
                <div id="file-info" class="hidden">
                    <span id="file-name"></span>
                    <button id="reset-btn" class="btn secondary">Reset</button>
                </div>
            </section>

            <section id="search-section" class="search-section hidden">
                <div class="controls-bar">
                    <div class="search-container">
                        <input type="text" id="search-input" placeholder="Search transactions...">
                    </div>
                    <div class="filter-container">
                        <select id="account-select" class="account-select hidden">
                            <option value="all">All Accounts</option>
                        </select>
                        <button id="export-btn" class="btn secondary">Export CSV</button>
                    </div>
                </div>
                <div class="stats">
                    <span id="match-count">0 matches found</span>
                </div>
            </section>

            <section id="results-section" class="results-section hidden">
                <div class="table-container">
                    <table id="results-table">
                        <thead>
                            <tr>
                                <th data-sort="date" class="sortable">Date <span class="sort-icon"></span></th>
                                <th data-sort="account" class="sortable">Account <span class="sort-icon"></span></th>
                                <th data-sort="description" class="sortable">Description <span class="sort-icon"></span></th>
                                <th data-sort="type" class="sortable">Transaction Type <span class="sort-icon"></span></th>
                                <th data-sort="amount" class="sortable" style="text-align: right;">Amount <span class="sort-icon"></span></th>
                            </tr>
                        </thead>
                        <tbody id="results-body">
                            <!-- Results will be injected here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="loading-indicator" class="hidden">
                <div class="spinner"></div>
                <p>Processing PDF...</p>
            </section>
        </main>
    </div>
    <script src="script.js"></script>
</body>
</html>
